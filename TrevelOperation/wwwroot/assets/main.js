let s=null;const a="travel-expense-theme-preference",n="dark",o="light",h={initialize:function(e,t=o){s=e;const c=localStorage.getItem(a)||t;this.applyThemeWithoutAnimation(c),this.fixBackgroundColors(),this.listenForSystemPreferenceChanges(),s&&s.invokeMethodAsync("NotifyThemeChanged",c)},getCurrentTheme:function(){return document.documentElement.getAttribute("data-theme")||n},setTheme:function(e){if(e!==n&&e!==o){console.error(`Invalid theme: ${e}. Must be 'dark' or 'light'`);return}this.getCurrentTheme()!==e&&(this.applyThemeWithAnimation(e),this.fixBackgroundColors(),localStorage.setItem(a,e),s&&s.invokeMethodAsync("NotifyThemeChanged",e))},toggleTheme:function(){const t=this.getCurrentTheme()===n?o:n;this.setTheme(t)},fixBackgroundColors:function(){const e=document.body,t=document.documentElement;e.style.backgroundColor="",t.style.backgroundColor="",this.getCurrentTheme()===o?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))},applyThemeWithAnimation:function(e){document.documentElement.setAttribute("data-theme",e)},applyThemeWithoutAnimation:function(e){document.documentElement.setAttribute("data-theme",e)},listenForSystemPreferenceChanges:function(){if(window.matchMedia){const e=window.matchMedia("(prefers-color-scheme: dark)");if(!localStorage.getItem(a)){const t=e.matches?n:o;this.applyThemeWithoutAnimation(t),this.fixBackgroundColors()}e.addEventListener("change",t=>{if(!localStorage.getItem(a)){const i=t.matches?n:o;this.applyThemeWithAnimation(i),this.fixBackgroundColors()}})}}};window.themeManager=h;window.themeManager=h;window.downloadFile=(e,t,i)=>{const c=new Blob([i],{type:t}),m=window.URL.createObjectURL(c),r=document.createElement("a");r.href=m,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(m)};window.validateCsvFile=e=>({isValid:e.type==="text/csv"||e.name.toLowerCase().endsWith(".csv"),size:e.size,name:e.name});
