let l=null;const h="travel-expense-theme-preference",s="dark",i="light",u={initialize:function(e,t=i){l=e;const n=localStorage.getItem(h)||t;this.applyThemeWithoutAnimation(n),this.fixBackgroundColors(),this.listenForSystemPreferenceChanges(),l&&l.invokeMethodAsync("NotifyThemeChanged",n)},getCurrentTheme:function(){return document.documentElement.getAttribute("data-theme")||s},setTheme:function(e){if(e!==s&&e!==i){console.error(`Invalid theme: ${e}. Must be 'dark' or 'light'`);return}this.getCurrentTheme()!==e&&(this.applyThemeWithAnimation(e),this.fixBackgroundColors(),localStorage.setItem(h,e),l&&l.invokeMethodAsync("NotifyThemeChanged",e))},toggleTheme:function(){const t=this.getCurrentTheme()===s?i:s;this.setTheme(t)},fixBackgroundColors:function(){const e=document.body,t=document.documentElement;e.style.backgroundColor="",t.style.backgroundColor="",this.getCurrentTheme()===i?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))},applyThemeWithAnimation:function(e){document.documentElement.setAttribute("data-theme",e)},applyThemeWithoutAnimation:function(e){document.documentElement.setAttribute("data-theme",e)},listenForSystemPreferenceChanges:function(){if(window.matchMedia){const e=window.matchMedia("(prefers-color-scheme: dark)");if(!localStorage.getItem(h)){const t=e.matches?s:i;this.applyThemeWithoutAnimation(t),this.fixBackgroundColors()}e.addEventListener("change",t=>{if(!localStorage.getItem(h)){const o=t.matches?s:i;this.applyThemeWithAnimation(o),this.fixBackgroundColors()}})}}};window.themeManager=u;window.themeManager=u;window.downloadFile=(e,t,o)=>{const n=new Blob([o],{type:t}),a=window.URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)};window.downloadFileBase64=(e,t,o)=>{const n=atob(e),a=new Array(n.length);for(let d=0;d<n.length;d++)a[d]=n.charCodeAt(d);const r=new Uint8Array(a),w=new Blob([r],{type:o}),m=window.URL.createObjectURL(w),c=document.createElement("a");c.href=m,c.download=t,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(m)};window.validateCsvFile=e=>({isValid:e.type==="text/csv"||e.name.toLowerCase().endsWith(".csv"),size:e.size,name:e.name});window.showToast=(e,t)=>{const o=document.createElement("div");o.className=`alert alert-${e} shadow-lg fixed top-4 right-4 w-96 z-[9999] animate-fade-in`;let n="";switch(e){case"success":n='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';break;case"error":n='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';break;case"warning":n='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>';break;case"info":n='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';break}o.innerHTML=`
        <div>
            ${n}
            <span>${t}</span>
        </div>
    `,document.body.appendChild(o),setTimeout(()=>{o.classList.add("animate-fade-out"),setTimeout(()=>{document.body.removeChild(o)},300)},5e3)};
