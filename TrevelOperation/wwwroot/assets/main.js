let i=null;const r="docuqa-theme-preference",n="forest-dark",c="light",s={initialize:function(e,t=n){i=e;const m=localStorage.getItem(r)||t;this.applyThemeWithoutAnimation(m),this.listenForSystemPreferenceChanges(),i&&i.invokeMethodAsync("NotifyThemeChanged",m)},getCurrentTheme:function(){return document.documentElement.getAttribute("data-theme")||n},setTheme:function(e){if(e!==n&&e!==c){console.error(`Invalid theme: ${e}. Must be 'dark' or 'light'`);return}this.getCurrentTheme()!==e&&(this.applyThemeWithAnimation(e),localStorage.setItem(r,e),i&&i.invokeMethodAsync("NotifyThemeChanged",e))},toggleTheme:function(){const t=this.getCurrentTheme()===n?c:n;this.setTheme(t)},applyThemeWithAnimation:function(e){document.documentElement.setAttribute("data-theme",e)},applyThemeWithoutAnimation:function(e){document.documentElement.setAttribute("data-theme",e)},listenForSystemPreferenceChanges:function(){if(window.matchMedia){const e=window.matchMedia("(prefers-color-scheme: dark)");if(!localStorage.getItem(r)){const t=e.matches?n:c;this.applyThemeWithoutAnimation(t)}e.addEventListener("change",t=>{if(!localStorage.getItem(r)){const a=t.matches?n:c;this.applyThemeWithAnimation(a)}})}}};window.themeManager=s;window.themeManager=s;window.downloadFile=(e,t,a)=>{const m=new Blob([a],{type:t}),h=window.URL.createObjectURL(m),o=document.createElement("a");o.href=h,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(h)};window.validateCsvFile=e=>({isValid:e.type==="text/csv"||e.name.toLowerCase().endsWith(".csv"),size:e.size,name:e.name});
